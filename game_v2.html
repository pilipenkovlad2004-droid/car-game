<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Car Rush</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
* {
    box-sizing: border-box;
    touch-action: manipulation;
}

html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle at top, #1e3c72, #0f2027);
    overflow: hidden;
    font-family: system-ui, sans-serif;
}

#game {
    position: relative;
    width: 100vw;
    height: 100vh;
}

#road {
    position: absolute;
    width: 70%;
    height: 100%;
    left: 15%;
    background: repeating-linear-gradient(
        #2c2c2c 0px,
        #2c2c2c 40px,
        #3a3a3a 40px,
        #3a3a3a 80px
    );
    box-shadow: inset 0 0 60px rgba(0,0,0,.8);
}

#car {
    position: absolute;
    width: 64px;
    height: 110px;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(180deg, #ff5252, #b71c1c);
    border-radius: 16px;
    box-shadow: 0 15px 30px rgba(0,0,0,.7);
    transition: left 0.2s cubic-bezier(.25,.8,.25,1);
}

.obstacle {
    position: absolute;
    width: 64px;
    height: 110px;
    top: -140px;
    background: linear-gradient(180deg, #ffd740, #ff6f00);
    border-radius: 16px;
    box-shadow: 0 10px 25px rgba(0,0,0,.7);
}

#hud {
    position: absolute;
    top: 15px;
    left: 15px;
    color: #fff;
    font-size: 20px;
    text-shadow: 0 2px 5px rgba(0,0,0,.7);
}

#menu {
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, rgba(0,0,0,.6), rgba(0,0,0,.9));
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: white;
}

button {
    padding: 16px 50px;
    font-size: 22px;
    border-radius: 40px;
    border: none;
    background: linear-gradient(180deg, #00e676, #00c853);
    color: black;
    box-shadow: 0 8px 25px rgba(0,0,0,.6);
}
</style>
</head>

<body>
<div id="game">
    <div id="road"></div>
    <div id="car"></div>

    <div id="hud">
        –û—á–∫–∏: <span id="score">0</span><br>
        –†–µ–∫–æ—Ä–¥: <span id="best">0</span>
    </div>

    <div id="menu">
        <h1>üöó CAR RUSH</h1>
        <button id="start">–°–¢–ê–†–¢</button>
    </div>
</div>

<script>
const car = document.getElementById("car");
const road = document.getElementById("road");
const scoreEl = document.getElementById("score");
const bestEl = document.getElementById("best");
const menu = document.getElementById("menu");
const startBtn = document.getElementById("start");

let carX = 50;
let speed = 2;
let score = 0;
let playing = false;
let obstacles = [];

bestEl.textContent = localStorage.getItem("best") || 0;

document.addEventListener("pointerdown", e => {
    if (!playing) return;
    if (e.clientX < window.innerWidth / 2) carX -= 10;
    else carX += 10;

    carX = Math.max(20, Math.min(80, carX));
    car.style.left = carX + "%";
});

function spawnObstacle() {
    const o = document.createElement("div");
    o.className = "obstacle";
    o.style.left = (20 + Math.random() * 60) + "%";
    road.appendChild(o);
    obstacles.push(o);
}

function loop() {
    if (!playing) return;

    score++;
    scoreEl.textContent = score;

    if (score % 300 === 0 && speed < 5) speed += 0.3; // –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    if (Math.random() < 0.02) spawnObstacle();

    obstacles.forEach((o, i) => {
        o.style.top = o.offsetTop + speed + "px";

        if (o.offsetTop > window.innerHeight) {
            o.remove();
            obstacles.splice(i, 1);
        }

        if (hit(car, o)) gameOver();
    });

    requestAnimationFrame(loop);
}

function hit(a, b) {
    const r1 = a.getBoundingClientRect();
    const r2 = b.getBoundingClientRect();
    return !(r1.right < r2.left || r1.left > r2.right || r1.bottom < r2.top || r1.top > r2.bottom);
}

function startGame() {
    score = 0;
    speed = 2;
    obstacles.forEach(o => o.remove());
    obstacles = [];
    menu.style.display = "none";
    playing = true;
    loop();
}

function gameOver() {
    playing = false;
    if (score > bestEl.textContent) {
        localStorage.setItem("best", score);
        bestEl.textContent = score;
    }
    menu.style.display = "flex";
}

startBtn.onclick = startGame;
</script>
</body>
</html>
