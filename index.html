<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Car Game</title>
<style>
body {
    margin: 0;
    background: #111;
    overflow: hidden;
}
#road {
    width: 300px;
    height: 100vh;
    margin: auto;
    background: #333;
    position: relative;
}
#car {
    width: 50px;
    height: 90px;
    background: red;
    position: absolute;
    bottom: 20px;
    left: 125px;
    border-radius: 8px;
}
.enemy {
    width: 50px;
    height: 90px;
    background: #666;
    position: absolute;
    top: -100px;
    border-radius: 8px;
}
#score {
    color: white;
    position: absolute;
    top: 10px;
    left: 10px;
}
</style>
</head>

<body>
<div id="road">
    <div id="score">–û—á–∫–∏: 0</div>
    <div id="car"></div>
</div>

<script>
let car = document.getElementById("car");
let scoreEl = document.getElementById("score");
let carX = 125;
let score = 0;
let speed = 3;
let enemies = [];

document.addEventListener("click", e => {
    let w = window.innerWidth;
    if (e.clientX < w / 2 && carX > 0) carX -= 50;
    if (e.clientX >= w / 2 && carX < 250) carX += 50;
    car.style.left = carX + "px";
});

function spawnEnemy() {
    let e = document.createElement("div");
    e.className = "enemy";
    e.style.left = Math.floor(Math.random() * 6) * 50 + "px";
    document.getElementById("road").appendChild(e);
    enemies.push(e);
}

function loop() {
    score++;
    scoreEl.innerText = "–û—á–∫–∏: " + score;

    if (score % 200 === 0) speed += 0.5;
    if (Math.random() < 0.03) spawnEnemy();

    enemies.forEach((e, i) => {
        e.style.top = e.offsetTop + speed + "px";

        if (e.offsetTop > window.innerHeight) {
            e.remove();
            enemies.splice(i, 1);
        }

        if (
            e.offsetTop + 90 > window.innerHeight - 120 &&
            Math.abs(e.offsetLeft - carX) < 40
        ) {
            Telegram.WebApp.sendData(JSON.stringify({ score }));
            alert("üí• –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞\n–û—á–∫–∏: " + score);
            location.reload();
        }
    });

    requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
